# Redux & Gunpack for Rockstar

![Screenshot](shapka_uzkaya.JPG)

**Auto Redux Gunpack** предназначена для запуска редукса на Rockstar версии GTA 5, используемой в GTA 5 RP или MAJESTIC RP. Программа автоматизирует процесс копирования файлов между различными директориями, необходимых для корректной работы редукса, что позволяет обновлять файлы игры в реальном времени и поддерживать работу модификации без вмешательства пользователя.

---


## Конфигурационный файл (config.json)

Конфигурация хранится в файле `config.json` и включает следующие параметры:

- **gunpack_new:**  
  *Строка.* Путь к директории, содержащей новые файлы для gunpack. Программа копирует файлы из этой директории в **gunpack_old**.

- **gunpack_old:**  
  *Строка.* Путь к целевой директории, куда копируются файлы для gunpack (обычно это директория обновлений GTA 5).

- **redux_new:**  
  *Строка.* Путь к директории, содержащей новые файлы для redux.

- **redux_old:**  
  *Строка.* Путь к директории, куда копируются файлы redux.

- **gta_exe_path:**  
  *Строка.* Полный путь к исполняемому файлу GTA5.exe. Если поле оставлено пустым при настройке, используется дефолтное значение:  
  `C:\Users\<USERNAME>\AppData\Local\altv-majestic\backup\GTA5.exe`

- **auto_run:**  
  *Булево значение.* Указывает, включён ли автозапуск программы при старте ПК. Если `true`, программа добавляется в автозапуск через реестр.

---

## Структура проекта

### main.go
Основная точка входа в программу. Файл содержит:
- Логику первичного запуска: если `config.json` отсутствует, запрашиваются все необходимые пути и настройки у пользователя.
- Логику повторного запуска: если конфигурация уже существует, программа работает в двух режимах:
    - **Ручной запуск:** Выводится сообщение «Программа запущена, все изменения вносите в config.json». Через 10 секунд консоль скрывается, а программа продолжает работать в фоне.
    - **Автозапуск:** Если программа запущена с параметром `-autostart`, окно консоли сразу скрывается, и программа работает в фоновом режиме.
- Запуск бесконечного цикла копирования файлов между указанными директориями.

### config.go
Определяет структуру `Config` и содержит:
- `loadConfig` — функция для загрузки конфигурации из `config.json`.
- `saveConfig` — функция для сохранения конфигурации в `config.json`.
- `prompt` — функция для запроса ввода у пользователя.

### logger.go
Настраивает логирование. Функция `initLogger` открывает (или создаёт) файл `app.log` для записи всех логов и ошибок.

### fileops.go
Содержит функции для работы с файлами:
- `copyFile` — копирует отдельный файл из источника в целевую директорию с перезаписью.
- `copyDirRecursive` — рекурсивно копирует содержимое директорий.

### autorun.go
Отвечает за автозапуск:
- `setAutoRun` — устанавливает или удаляет запись автозапуска в реестре Windows.
- `hideConsole` — скрывает окно консоли, чтобы программа работала в фоне.

### processcheck.go
Содержит функции для проверки запущенных процессов:
- `getRunningProcesses` — получает список процессов с помощью команды `tasklist`.
- `checkIfProcessRunning` — проверяет, запущен ли процесс по имени.
- `isProcessRunningByPath` — проверяет наличие процесса по полному пути с использованием `wmic`.

---

## Как пользоваться программой

### Первичный запуск
При первом запуске, если файл `config.json` отсутствует, программа:
1. Запустится в режиме настройки и запросит следующие данные:
    - **gunpack-new:** Путь к директории с новыми файлами для gunpack.
    - **gunpack-old:** Путь к целевой директории для gunpack.
    - **redux-new:** Путь к директории с новыми файлами для redux.
    - **redux-old:** Путь к целевой директории для redux.
    - **Путь к GTA5.exe:** Полный путь к исполняемому файлу GTA5. Если оставить поле пустым, будет использовано дефолтное значение.
    - Вопрос об автозапуске: Если вы отвечаете "y", программа добавится в автозапуск.
2. Все введённые данные сохраняются в `config.json`.
3. После ввода настроек консоль скрывается, и запускается цикл копирования файлов в фоне.

### Повторный запуск
Если `config.json` уже существует:
- **Ручной запуск:**  
  При запуске без параметра `-autostart` выводится сообщение «Программа запущена, все изменения вносите в config.json». Через 10 секунд консоль скрывается, а программа продолжает работать в фоне.
- **Автозапуск:**  
  При запуске с параметром `-autostart` окно консоли сразу скрывается, и программа работает в фоне без какого-либо вывода на экран.

### Цикл копирования файлов
Программа каждые 5 секунд проверяет, запущен ли процесс GTA5.exe (по имени или по указанному пути):
- Если процесс обнаружен, программа ждет 5 секунд и продолжает проверку.
- Если процесс не запущен, происходит копирование файлов:
    - Файлы из **gunpack-new** копируются в **gunpack-old**.
    - Файлы из **redux-new** копируются в **redux-old**.
    - Дополнительно файлы из **redux-new** копируются в дефолтную папку backup:  
      `C:\Users\<USERNAME>\AppData\Local\altv-majestic\backup`

### Проверка автозапуска
Чтобы проверить, что программа добавлена в автозапуск:
1. **Через редактор реестра:**
    - Нажмите `Win+R`, введите `regedit` и нажмите Enter.
    - Перейдите в раздел:  
      `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run`
    - Найдите запись с именем `auto-redux-gunpack` и проверьте её значение (должно содержать путь к исполняемому файлу с параметром `-autostart`).

2. **Через командную строку:**
    - Выполните команду:
      ```batch
      reg query HKCU\Software\Microsoft\Windows\CurrentVersion\Run
      ```
    - Найдите нужную запись в выводе.

---

## Структура работы файлов

- **main.go:**  
  Основная логика запуска программы. Обрабатывает первичный и повторный запуск, определяет режим работы (ручной или автозапуск) и запускает цикл копирования.

- **config.go:**  
  Определяет конфигурационную структуру и функции для загрузки/сохранения настроек, а также функцию `prompt` для взаимодействия с пользователем.

- **logger.go:**  
  Инициализирует логирование, записывая все сообщения в `app.log`.

- **fileops.go:**  
  Реализует функции для копирования файлов и директорий, включая рекурсивное копирование с использованием горутин.

- **autorun.go:**  
  Содержит функции для установки автозапуска через реестр Windows (функция `setAutoRun`) и для скрытия окна консоли (`hideConsole`).

- **processcheck.go:**  
  Реализует функции для проверки запущенных процессов (как по имени, так и по полному пути с использованием утилиты `wmic`).

---

## Заключение

**Auto Redux Gunpack** — это утилита, разработанная для автоматического запуска редукса на Rockstar версии GTA 5, используемой в GTA 5 RP или MAJESTIC RP. Она позволяет автоматизировать копирование необходимых файлов между директориями, обеспечивая стабильную работу модификации. Все настройки хранятся в конфигурационном файле, а программа может работать как в ручном режиме, так и в режиме автозапуска, скрывая консоль для работы в фоне.

Нажмите одну кнопку, чтобы скопировать этот текст в `README.md` и использовать его для вашего проекта.
